<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Personalized Fitness System</title>
    <meta name="description" content="A lightweight personalized fitness system: profile intake, plan generator, workout + bodyweight logging, and progress charts." />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="title">Personalized Fitness System</div>
          <div class="subtitle">Profile → Plan → Log → Progress (stored locally)</div>
        </div>
        <nav class="nav" aria-label="Primary">
          <button class="tab" id="tab-profile" type="button">Profile</button>
          <button class="tab" id="tab-plan" type="button">Plan</button>
          <button class="tab" id="tab-log" type="button">Log</button>
          <button class="tab" id="tab-progress" type="button">Progress</button>
          <button class="tab" id="tab-settings" type="button">Settings</button>
        </nav>
      </header>

      <section class="hero" aria-live="polite">
        <h1 id="heroTitle">Your Personalized Fitness System</h1>
        <p>
          A practical, rules-based coach to generate a weekly plan from your profile, then track workouts and progress over time.
          Data stays in your browser unless you export it.
        </p>
        <div class="pillrow">
          <div class="pill" id="pillPlan"><strong>Plan</strong> —</div>
          <div class="pill" id="pillUpdated"><strong>Updated</strong> —</div>
          <div class="pill" id="pillDays"><strong>—</strong> days/week</div>
          <div class="pill" id="pillGoal"><strong>Goal</strong> —</div>
        </div>
      </section>

      <!-- ===================== VIEW: PROFILE ===================== -->
      <section class="view" id="view-profile">
        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Your profile</div>
              <div class="actions">
                <button class="btn small" type="button" id="btnSaveProfile">Save profile</button>
                <button class="btn small primary" type="button" id="btnGenerate">Generate plan</button>
              </div>
            </div>
            <div class="body">
              <div class="form two">
                <div class="field">
                  <label for="p_name">Name (optional)</label>
                  <input id="p_name" type="text" placeholder="e.g. Alex" autocomplete="name" />
                </div>
                <div class="field">
                  <label for="p_sex">Sex (for BMR estimate)</label>
                  <select id="p_sex">
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                  </select>
                </div>
              </div>

              <div class="form three" style="margin-top:12px;">
                <div class="field">
                  <label for="p_age">Age</label>
                  <input id="p_age" type="number" inputmode="numeric" min="10" max="120" placeholder="e.g. 32" />
                </div>
                <div class="field">
                  <label for="p_height">Height (cm)</label>
                  <input id="p_height" type="number" inputmode="decimal" min="120" max="230" placeholder="e.g. 178" />
                </div>
                <div class="field">
                  <label for="p_weight">Weight (kg)</label>
                  <input id="p_weight" type="number" inputmode="decimal" min="35" max="250" placeholder="e.g. 82" />
                </div>
              </div>

              <div class="form three" style="margin-top:12px;">
                <div class="field">
                  <label for="p_goal">Primary goal</label>
                  <select id="p_goal">
                    <option value="general">General health</option>
                    <option value="fat_loss">Fat loss</option>
                    <option value="muscle_gain">Muscle gain</option>
                    <option value="endurance">Endurance</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p_exp">Experience</label>
                  <select id="p_exp">
                    <option value="beginner">Beginner</option>
                    <option value="intermediate">Intermediate</option>
                    <option value="advanced">Advanced</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p_activity">Baseline activity</label>
                  <select id="p_activity">
                    <option value="sedentary">Sedentary</option>
                    <option value="light">Light</option>
                    <option value="moderate">Moderate</option>
                    <option value="high">High</option>
                  </select>
                </div>
              </div>

              <div class="form three" style="margin-top:12px;">
                <div class="field">
                  <label for="p_days">Days/week</label>
                  <select id="p_days">
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p_minutes">Session length (minutes)</label>
                  <select id="p_minutes">
                    <option value="30">30</option>
                    <option value="45">45</option>
                    <option value="60">60</option>
                    <option value="75">75</option>
                    <option value="90">90</option>
                  </select>
                </div>
                <div class="field">
                  <label for="p_eq">Equipment</label>
                  <select id="p_eq">
                    <option value="none">None (bodyweight)</option>
                    <option value="dumbbells">Dumbbells</option>
                    <option value="full_gym">Full gym</option>
                  </select>
                </div>
              </div>

              <div class="form two" style="margin-top:12px;">
                <div class="field">
                  <label for="p_injuries">Injuries / constraints (optional)</label>
                  <textarea id="p_injuries" placeholder="e.g. lower-back sensitive, avoid heavy hinging"></textarea>
                </div>
                <div class="field">
                  <label for="p_prefs">Preferences (optional)</label>
                  <textarea id="p_prefs" placeholder="e.g. prefer full-body workouts, extra focus on glutes + posture"></textarea>
                </div>
              </div>

              <div class="hint">
                Plan quality improves with age/height/weight. If you’re unsure, leave blanks and focus on training consistency first.
              </div>
            </div>
          </div>

          <div class="card">
            <div class="head">
              <div class="h">Quick estimates</div>
            </div>
            <div class="body">
              <div class="kpi" id="profileSummary"></div>
              <div class="hint" style="margin-top:10px;">
                These are estimates, not medical advice. If you have a condition, pain, or are pregnant, consult a professional.
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ===================== VIEW: PLAN ===================== -->
      <section class="view" id="view-plan">
        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Your plan</div>
              <div class="actions">
                <button class="btn small" type="button" id="btnGenerate2">Regenerate</button>
              </div>
            </div>
            <div class="body" id="planWrap"></div>
          </div>

          <div class="card">
            <div class="head">
              <div class="h">How to use it</div>
            </div>
            <div class="body">
              <div class="list">
                <div class="item">
                  <div class="meta">
                    <div class="t">Train consistently</div>
                    <div class="d">Hit your weekly days. If you miss a day, resume—don’t “make up” with double sessions.</div>
                  </div>
                </div>
                <div class="item">
                  <div class="meta">
                    <div class="t">Progress slowly</div>
                    <div class="d">Add a little weight or reps only when sets feel solid with ~2–3 reps in reserve.</div>
                  </div>
                </div>
                <div class="item">
                  <div class="meta">
                    <div class="t">Track the basics</div>
                    <div class="d">Log workouts and bodyweight weekly. Small trends matter more than single-day spikes.</div>
                  </div>
                </div>
                <div class="item">
                  <div class="meta">
                    <div class="t">Adjust with data</div>
                    <div class="d">If weight is flat for 2–3 weeks, change calories by ~150–250/day or add steps.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ===================== VIEW: LOG ===================== -->
      <section class="view" id="view-log">
        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Log workout</div>
            </div>
            <div class="body">
              <div class="form two">
                <div class="field">
                  <label for="w_date">Date</label>
                  <input id="w_date" type="date" />
                </div>
                <div class="field">
                  <label for="w_type">Type</label>
                  <select id="w_type">
                    <option value="strength">Strength</option>
                    <option value="cardio">Cardio</option>
                    <option value="mobility">Mobility</option>
                  </select>
                </div>
              </div>
              <div class="form two" style="margin-top:12px;">
                <div class="field">
                  <label for="w_title">Title (optional)</label>
                  <input id="w_title" type="text" placeholder="e.g. Full Body A" />
                </div>
                <div class="field">
                  <label for="w_minutes">Duration (minutes)</label>
                  <input id="w_minutes" type="number" inputmode="numeric" min="5" max="300" placeholder="e.g. 45" />
                </div>
              </div>
              <div class="form two" style="margin-top:12px;">
                <div class="field">
                  <label for="w_rpe">RPE (optional)</label>
                  <input id="w_rpe" type="number" inputmode="numeric" min="1" max="10" placeholder="1–10" />
                </div>
                <div class="field">
                  <label>&nbsp;</label>
                  <button class="btn primary" type="button" id="btnAddWorkout">Add workout</button>
                </div>
              </div>
              <div class="field" style="margin-top:12px;">
                <label for="w_notes">Notes (optional)</label>
                <textarea id="w_notes" placeholder="e.g. felt strong, increased squat by +2.5kg"></textarea>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="head">
              <div class="h">Log body metrics</div>
            </div>
            <div class="body">
              <div class="form two">
                <div class="field">
                  <label for="b_date">Date</label>
                  <input id="b_date" type="date" />
                </div>
                <div class="field">
                  <label for="b_weight">Weight (kg)</label>
                  <input id="b_weight" type="number" inputmode="decimal" min="30" max="250" placeholder="e.g. 82.4" />
                </div>
              </div>
              <div class="form two" style="margin-top:12px;">
                <div class="field">
                  <label for="b_waist">Waist (cm) (optional)</label>
                  <input id="b_waist" type="number" inputmode="decimal" min="40" max="180" placeholder="e.g. 86" />
                </div>
                <div class="field">
                  <label>&nbsp;</label>
                  <button class="btn primary" type="button" id="btnAddBody">Add entry</button>
                </div>
              </div>
              <div class="field" style="margin-top:12px;">
                <label for="b_notes">Notes (optional)</label>
                <textarea id="b_notes" placeholder="e.g. morning weigh-in, after rest day"></textarea>
              </div>
            </div>
          </div>
        </div>

        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Recent workouts</div>
            </div>
            <div class="body" id="workoutList"></div>
          </div>
          <div class="card">
            <div class="head">
              <div class="h">Recent body entries</div>
            </div>
            <div class="body" id="bodyList"></div>
          </div>
        </div>
      </section>

      <!-- ===================== VIEW: PROGRESS ===================== -->
      <section class="view" id="view-progress">
        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Weight trend</div>
            </div>
            <div class="body">
              <div class="canvaswrap">
                <canvas id="weightChart"></canvas>
              </div>
              <div class="hint">Tip: log weight 3–7x/week, then focus on weekly averages.</div>
            </div>
          </div>
          <div class="card">
            <div class="head">
              <div class="h">Workout consistency</div>
            </div>
            <div class="body">
              <div class="canvaswrap">
                <canvas id="workoutChart"></canvas>
              </div>
              <div class="hint">Consistency is the #1 predictor of results. Aim for your planned weekly frequency.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- ===================== VIEW: SETTINGS ===================== -->
      <section class="view" id="view-settings">
        <div class="grid two">
          <div class="card">
            <div class="head">
              <div class="h">Backup & data</div>
            </div>
            <div class="body">
              <div class="actions">
                <button class="btn" type="button" id="btnExport">Export backup</button>
                <button class="btn" type="button" id="btnImport">Import backup</button>
                <button class="btn danger" type="button" id="btnReset">Reset everything</button>
              </div>
              <div class="hint" style="margin-top:10px;">
                Export creates a JSON file with your profile, plan, and logs. Import replaces current data with the file content.
              </div>
            </div>
          </div>

          <div class="card">
            <div class="head">
              <div class="h">About this MVP</div>
            </div>
            <div class="body">
              <div class="hint">
                This is a rules-based generator (not AI coaching). It’s designed to be safe-by-default and easy to extend.
                Next steps could include exercise libraries, progression tracking per lift, and meal planning templates.
              </div>
              <div class="footer">
                <div><strong>Privacy:</strong> stored in your browser `localStorage`.</div>
                <div><strong>Disclaimer:</strong> educational only; not medical advice.</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <div class="toast" id="toast" role="status" aria-live="polite"></div>

      <!-- Modal -->
      <div class="modalOverlay" id="modalOverlay" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal">
          <div class="mhead" id="modalTitle">Confirm</div>
          <div class="mbody" id="modalBody"></div>
          <div class="mfoot">
            <button class="btn" type="button" id="modalCancel">Cancel</button>
            <button class="btn danger" type="button" id="modalConfirm">Confirm</button>
          </div>
        </div>
      </div>
    </div>

    <script src="./engine.js"></script>
    <script src="./app.js"></script>
    <script>
      // Secondary regenerate button lives in Plan view; wire it here so app.js stays simple.
      window.addEventListener("DOMContentLoaded", () => {
        const btn = document.getElementById("btnGenerate2");
        if (btn) btn.addEventListener("click", () => document.getElementById("btnGenerate")?.click());
      });
    </script>
  </body>
</html>
